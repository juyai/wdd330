<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Week 7 Notes</title>
  </head>
  <body>
    <h1>Week 7</h1>
    <h2>Notes</h2>
    <h3>AJAX</h3>
    <p>
      a technique that allows web pages to communicate asynchronously with a
      server
    </p>
    <p>dynamically updates web pages without reloading.</p>
    <p>
      portions of a page to be updated in response to user events, while the
      rest of the program continues to run.
    </p>

    <h3>Clients and Servers</h3>
    <p>
      The web of computers known as the internet can be separated into two
      parts: clients and servers.
    </p>
    <p>
      Un cliente, como un navegador web, solicitará un recurso <br />
      (generalmente una página web) de
      <b
        >un servidor, que procesa la solicitud <br />
        y envía una respuesta al cliente</b
      >.
    </p>
    <p>
      JavaScript--adding <b>dynamic features</b> to the
      <i>web page that was returned from the server</i>.
    </p>
    <p>
      <i
        ><mark
          ><b>Ajax permite que JavaScript</b> solicite recursos de un servidor
          en nombre del cliente. <br />
          Los recursos solicitados suelen ser:
        </mark></i
      >
    </p>
    <ul>
      <li>datos JSON</li>
      <li>pequeños fragmentos de texto</li>
      <li>HTML</li>
    </ul>
    <p>en lugar de una página web completa</p>
    <p>
      <b
        >a
        <mark
          ><i>server</i> is required when requesting resources
          <b>using Ajax</b>.</mark
        ></b
      >
    </p>
    <p>
      Typically this involves using a server-side language, such as PHP, Ruby,
      Node.js, or .NET <br />
      to serve the data response following an Ajax request (usually from a
      back-end database).
    </p>

    <h3>APIs</h3>
    <p>
      collection of methods that allows external access to another program or
      service.
    </p>

    <h4>Fetch API</h4>
    <p>global <b>fetch()</b> method</p>
    <p>
      it has just one mandatory argument: the URL of the resource you wish to
      <i>fetch/obtener</i>
    </p>
    <p>
      fetch('https://example.com/data') <br />
      .then( // code that handles the response ) <br />
      .catch( // code that runs if the server returns an error )
    </p>

    <p><b>the fetch() method returns a promise</b></p>
    <p>
      promesa que <i>se resuelve en la respuesta devuelta por la URL</i> que se
      proporcionó como argumento.
    </p>
    <p>la promesa se resolverá cuando se reciba una respuesta de la URL</p>
    <p>
      Because it's a promise, we can also use a <b>catch</b> statement at the
      end to deal with any errors that may occur.
    </p>

    <h3>Response Interface</h3>
    <p>
      the Response Interface: deals with
      <mark>the object that's returned</mark> when the promise is fulfilled
    </p>
    <p>AN OBJECT IS RETURNED <mark>WHEN THE PROMISE IS FULFILLED</mark></p>
    <p>
      <b>Response objects</b> have a
      <i>number of properties and methods</i> that allow us to
      <mark>process the response effectively</mark>.
    </p>

    <h4>ok property</h4>
    <p>checks to see if the response is successful.</p>

    <h4>status property</h4>
    <p>access to dHTTP status code</p>
    <ul>
      <li>200 if the response was successful</li>
      <li>201 if a resource was created</li>
      <li>204 when the request is successful but no content is returned</li>
    </ul>
    <p>
      The ok property will return true if the status property is between 200 and
      299
    </p>
    <p>
      const url = 'https:example.com/data'; <br />
      <br />
      fetch(url)<br />
      .then((response) => {<br />
      if(response.ok) {<br />
      return response;<br />
      }<br />
      throw Error(response.statusText);<br />
      })<br />
      .then( response => // do something with response )<br />
      .catch( error => console.log('There was an error!') )
    </p>

    <h4>Some other properties of the Response object are:</h4>
    <h5>headers</h5>
    <p>Headers object: containing any headers associated with the response</p>

    <h5>url</h5>
    <p>A string containing the URL of response</p>

    <h5>redirected</h5>
    <p>
      A boolean value that specifies if the response is the result of a redirect
    </p>

    <h5>type</h5>
    <p>
      A string value of 'basic', 'cors', 'error' or 'opaque'. <br />
      A value of 'basic' is used for a response from the same domain. <br />
      A value of 'cors' means the data was received from a valid cross-origin
      request from a different domain.<br />
      A value of 'opaque' is used for a response received from 'no-cors' request
      from another domain, which means<br />
      access to the data will be severely restricted. <br />
      A value of 'error' is used when a network error occurs.
    </p>

    <h5>redirect() method</h5>
    <p>
      redirect to another URL. It creates a new promise that resolves to the
      response from the redirected URL.
    </p>
    <p>
      fetch(url)<br />
      .then( response => response.redirect(newURL)); // redirects to another
      URL<br />
      .then( // do something else )<br />
      .catch( error => console.log('There was an error: ', error))
    </p>

    <h4>Text Responses</h4>
    <h5>text() method</h5>
    <p>
      toma un flujo de texto de la respuesta, lo lee hasta el final y luego
      devuelve <br />
      una promesa que se resuelve en un objeto USVSting <br />
      USVSting object that can be treated as a string in JavaScript.
    </p>
    <p>
      fetch(url)<br />
      .then( response => response.text() ); // transforms the text stream into a
      JavaScript string<br />
      .then( text => console.log(text) )<br />
      .catch( error => console.log('There was an error: ', error))
    </p>

    <h4>File Responses</h4>
    <h5>blob() method</h5>
    <p>
      para leer un archivo de datos sin procesar, como una imagen o una hoja de
      cálculo. <br />
      Una vez que ha leído todo el archivo, devuelve una promesa que se resuelve
      con un objeto blob.
    </p>
    <p>
      fetch(url)<br />
      .then( response => response.blob() ); // transforms the data into a blob
      object<br />
      .then( blob => console.log(blob.type) )<br />
      .catch( error => console.log('There was an error: ', error))
    </p>
    <p>
      we use the blob() method to return a blob object.<br />
      We then use the type property to log what type of file we have received.
    </p>

    <h4>JSON Responses</h4>
    <h5>json() method</h5>
    <p>formato más común para las respuestas de AJAX</p>
    <p>
      transforma un flujo de datos JSON en una promesa que se resuelve
      <b>en un objeto JavaScript</b>.
    </p>
    <p>
      fetch(url)<br />
      .then( response => response.json() ); // transforms the JSON data into a
      JavaScript object<br />
      .then( data => console.log(Object.entries(data)) )<br />
      .catch( error => console.log('There was an error: ', error))
    </p>
    <p>
      JSON data that is resolved as a JavaScript object. <br />
      we can manipulate the object using JavaScript. <br />
      <b>Object.entries() method</b> is used to view the
      <b>key and value pairs in the returned object</b>.
    </p>

    <h4>Creating Response Objects</h4>
    <p>create your own response objects using a constructor function</p>
    <p>
      const response = new Response( 'Hello!', {<br />
      ok: true,<br />
      status: 200,<br />
      statusText: 'OK',<br />
      type: 'cors',<br />
      url: '/api'<br />
      });
    </p>
    <p>
      The first argument is the data that is to be returned (for example a text
      stream,<br />
      file or JSON data). <br />
      The second argument is an object that can be used to provide values for
      any of the <br />
      properties listed above.
    </p>

    <h4>Request Interface</h4>
    <p>
      more fine-grained control over the request being made by providing a
      Request object as an argument. <br />
      This allows a number of options to be set about the request.
    </p>
    <p>Request() constructor, include the following properties</p>
    <ul>
      <li>
        url - The URL of the requested resource (the only property that is
        required)
      </li>
      <li>
        method - a string that specifies which HTTP method should be used for
        the request. By default, this is 'GET'.
      </li>
      <li>
        headers - This is a Headers object that provides details of the
        request's headers.
      </li>
      <li>
        mode - Allows you to specify if CORS is used or not. CORS is enabled by
        default.
      </li>
      <li>
        cache - Allows you to specify how the request will use the browser's
        cache. For example, you can force it to request a resource and update
        the cache with the result, or you can force it to only look in the cache
        for the resource.
      </li>
      <li>
        credentials - Lets you specify if cookies should be allowed with the
        request.
      </li>
      <li>
        redirect - Specifies what to do if the response returns a redirect.
        There's a choice of three values: 'follow' (the redirect is followed),
        'error' (an error is thrown) or 'manual' (the user has to click on a
        link to follow the redirect).
      </li>
    </ul>

    <h4>HTTP Methods OR VERBS</h4>
    <p>
      HTTP uses to tell the server what type of request is being made, which
      then determines <br />
      the server will deal with the request.
    </p>
    <ul>
      <li>Solicitudes GET para recuperar recursos</li>
      <li>
        Solicitudes POST, generalmente utilizadas para crear un recurso, pero en
        realidad pueden realizar cualquier tarea
      </li>
      <li>
        Solicitudes PUT para upsert, lo que significa insertar un recurso o
        actualizarlo por completo
      </li>
      <li>
        Solicitudes PATCH para realizar actualizaciones parciales de un recurso
      </li>
      <li>DELETE requests to delete a resources.</li>
    </ul>
    <p>
      const request = new Request('https://example.com/data', {<br />
      method: 'GET',<br />
      mode: 'cors',<br />
      redirect: 'follow',<br />
      cache: 'no-cache'<br />
      });
    </p>
    <p>
      Once the Request object is assigned to a variable, it can then be used as
      the parameter of the fetch() method
    </p>
    <p>
      OR enter the URL and object directly as arguments of the fetch() method,
      without having to create a Request object
    </p>

    <h4>HTTP headers</h4>
    <p>to pass on any additional information about a request or response</p>
    <p>
      Typical information contained in headers includes the file-type of the
      resource, cookie information, authentication information and when the
      resource was last modified.
    </p>
    <p>
      Headers object includes the following properties and methods that can be
      used to access information about the headers, as well as edit the header
      information.
    </p>
    <h5>has()</h5>
    <p>
      Can be used to check if the headers object contains the header provided as
      an argument.
    </p>

    <h5>get()</h5>
    <p>Returns the value of the header provided as an argument</p>
    <p>headers.get('Content-Type'); -- 'text/plain'</p>

    <h3>set()</h3>
    <p>
      set a value of an already existing header, or create a new header with the
      value provided as an argument if it does not already exist.
    </p>
    <p>headers.set('Content-Type', 'application/json');</p>

    <h3>append()</h3>
    <p>Adds a new header to the headers object.</p>
    <p>headers.append('Accept-Encoding','gzip,deflate');</p>

    <h3>delete()</h3>
    <p>Removes the header provided as an argument</p>
    <p>headers.delete('Accept-Encoding')</p>

    <h3>keys(), values() and entries()</h3>
    <p>Iterators that can be used to iterate over the headers</p>
    <p>
      for(const entry of headers.entries(){<br />
      console.log(entry);<br />
      }<br />
      --[ 'Content-Type', 'application/json' ]
    </p>

    <h4>Receiving Information</h4>
    <p>how to update a web page using Ajax</p>

    <h4>Sending Information</h4>
    <p>
      Ajax to send information. This can be a variety of formats, but is usually
      a JSON string.
    </p>

    <h4>FormData</h4>
    <p>Fetch API includes the FormData interface</p>
    <p>makes it much easier to submit information in forms using Ajax.</p>
    <p>
      The FormData instance will automatically create the necessary settings
      required, and take care of all the hard work if any file uploads are
      present in the form.
    </p>
  </body>
</html>
